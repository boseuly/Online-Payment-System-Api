<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.store.passmeby.PassMeByApi.dao.CustomerDao">

    <!--   그룹에 속한 파일 전체 조회  -->
    <select id="findByUsername" resultType="com.store.passmeby.PassMeByApi.dao.vo.Users">
        SELECT * FROM SYSTEM.TB_CUSTOMER
        WHERE EMAIL = #{email}
    </select>

    <!--  refreshToken 통해 유저 조회  -->
    <select id="findByRefreshToken" resultType="com.store.passmeby.PassMeByApi.dao.vo.Users">
        SELECT * FROM SYSTEM.TB_CUSTOMER
        WHERE REFRESH_TOKEN = #{refreshToke}
    </select>

    <select id="findByEmail" resultType="com.store.passmeby.PassMeByApi.dao.vo.Users">
        SELECT * FROM SYSTEM.TB_CUSTOMER
        WHERE EMAIL = #{email}
    </select>

    <!--  아이디 중복 검사  -->
    <select id="selectByCustomerId" resultType="java.lang.Integer">
        SELECT COUNT(*) > 0
        FROM SYSTEM.TB_CUSTOMER
        WHERE CUSTOMER_ID = #{id}
    </select>

    <!--  이메일 중복 검사  -->
    <select id="selectByCustomerEmail" resultType="java.lang.Integer">
        SELECT COUNT(*) > 0
        FROM SYSTEM.TB_CUSTOMER
        WHERE EMAIL = #{email}
    </select>

    <!-- 회원 가입 -->
    <insert id="insertCustomer">
        insert into SYSTEM.TB_CUSTOMER(customer_id,
                                password,
                                customer_name,
                                gender,
                                email,
                                phone_number,
                                point,
                                withdraw_yn)
        values (#{vo.customerId},
                #{vo.password},
                #{vo.customerName},
                'W',
                #{vo.email},
                #{vo.phoneNumber},
                0,
                'N')
    </insert>

    <!--  refreshToken 저장  -->
    <insert id="insertRefreshToken">
        update SYSTEM.TB_CUSTOMER
        set REFRESH_TOKEN = #{refreshToken}
    </insert>
</mapper>